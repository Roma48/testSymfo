{% extends '::base.html.twig' %}

{% block body %}
    <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <h3>
                Деталі завдання
                <div class="pull-right">
                    <a href="{{ path('cto_jobs_print', {'id': job.id}) }}" target="_blank" class="btn btn-sm btn-info">Роздрукувати</a>
                    <a href="#" class="btn btn-sm btn-success">Додати рекомендацію</a>
                    <a href="{{ path('cto_jobs_addReminder', {'jobId': job.id}) }}" class="btn btn-sm btn-success">Додати нагадування</a>
                    <a href="{{ path('cto_jobs_list') }}" class="btn btn-sm btn-default"><i class="fa fa-arrow-left"></i>&nbsp;&nbsp;&nbsp;Назад</a>
                </div>
            </h3>
            <br>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <h4><u>Загальна інформація про клієнта:</u></h4>
            <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="font-bolder">Ім'я: </span>{{ job.client.firstName }}&nbsp;&nbsp;(<a href="{{ path('cto_client_show', {"slug": job.client.slug }) }}">Профайл кліента</a>)</p>
            <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="font-bolder">Прізвище: </span>{{ job.client.lastName }}</p>
            <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="font-bolder">Кількість автомобілів: </span>{{ job.client.cars | length }}</p>
            <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="font-bolder">Дата останнього візиту: </span>{{ job.client.lastVisitDate | date("d.m.Y") }}</p>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <h4><u>Завдання:</u></h4>
            <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="font-bolder">Дата: </span>{{ job.jobDate | date("d.m.Y") }}</p>
            <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="font-bolder">Автомобіль: </span>
            {% if job.car.model is defined%}
                {{ job.car.model.name }}
            {% endif %}
            </p>
            <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="font-bolder">Витрачено на ремонт (клієнтом): </span>{{ job.totalCost | number_format(2, '.', ',') }} грн.</p>
            <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="font-bolder">Витрачено на ремонт (CTO): </span>{{ job.totalSpend | number_format(2, '.', ',') }} грн.</p>
            <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="font-bolder">Прибуток CTO: </span>{{ (job.totalCost - job.totalSpend) | number_format(2, '.', ',') }} грн.</p>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
            <h4 class="text-center"><u>По категоріям:</u></h4>

            {% for category in job.carCategories %}
                <h5>&nbsp;&nbsp;&nbsp;{{ category.jobCategory.name }}</h5>
                {% if category.jobDescriptions | length > 0 %}
                    <div class="well well-sm">
                        {% for description in category.jobDescriptions %}
                            <p><span class="font-bolder">Опис: </span>{{ description.description }}</p>
                            <p><span class="font-bolder">Ціна: </span>{{ description.price | number_format(2, '.', ',') }} грн.</p>
                        {% endfor %}
                    </div>
                {% endif %}
            {% endfor %}
        </div>

        <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
            <h4 class="text-center"><u>Витрати СТО:</u></h4>
            <h5>&nbsp;&nbsp;&nbsp;Затрачено на деталі</h5>
                {% if job.spendingJob | length > 0 %}
                    <div class="well well-sm">
                        {% for spending in job.spendingJob %}
                            <p><span class="font-bolder">Опис: </span>{{ spending.description }}</p>
                            <p><span class="font-bolder">Ціна: </span>{{ spending.price | number_format(2, '.', ',') }} грн.</p>
                        {% endfor %}
                    </div>
                {% endif %}
            <h5>&nbsp;&nbsp;&nbsp;Затрачено на метеріали</h5>
                {% if job.usedMaterialsJob | length > 0 %}
                    <div class="well well-sm">
                        {% for used in job.usedMaterialsJob %}
                            <p><span class="font-bolder">Опис: </span>{{ used.description }}</p>
                            <p><span class="font-bolder">Ціна: </span>{{ used.price | number_format(2, '.', ',') }} грн.</p>
                        {% endfor %}
                    </div>
                {% endif %}
            <h5>&nbsp;&nbsp;&nbsp;Виплачена зарплата</h5>
                {% if job.paidSalaryJob | length > 0 %}
                    <div class="well well-sm">
                        {% for paid in job.paidSalaryJob %}
                            <p><span class="font-bolder">Кому: </span>{{ paid.description }}</p>
                            <p><span class="font-bolder">Сума: </span>{{ paid.price | number_format(2, '.', ',') }} грн.</p>
                        {% endfor %}
                    </div>
                {% endif %}
        </div>
    </div>
{% endblock %}
